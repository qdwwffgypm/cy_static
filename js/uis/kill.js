!function(a,b){if("undefined"!=typeof module)require("../libs/stringUtil"),require("../utils/ajaxUtil"),require("../utils/serverUtil"),require("../utils/userUtil"),require("../libs/dialog"),module.exports=b(a);else if(b(a),"function"==typeof define&&(define.amd||define.cmd)){var c="//"+(/ppppoints.com/.test(document.domain)?"j.ppppoints.com":"j.changyoyo.com")+"/static/js/";requirejs.config({paths:{stringUtil:c+"libs/stringUtil",ajaxUtil:c+"utils/ajaxUtil",serverUtil:c+"utils/serverUtil",userUtil:c+"utils/userUtil",dialog:c+"libs/dialog"}}),define("kill",["stringUtil","ajaxUtil","serverUtil","userUtil","dialog"],function(){return b(a)})}}(window||this,function(a){var c,b,d,e;return!a.CY&&(a.CY={}),a.CY.kill?a.CY.kill:(b=document,e=function(a){return a+(Math.random()+"").slice(9)},c=function(){var c,f,g,h,i,j,l,m,n,o,p,r,a=[];return a.push('<div class="l-item {statusCSS}">'),a.push('    <a href="{link}" data-spm="{keyId}">'),a.push("        <article>"),a.push('            <span class="top {topCss}"></span>'),a.push('            <span class="l-img">'),a.push('                <img alt="{goodsName}" src="{centerPic}">'),a.push("                <label>{label}</label>"),a.push("            </span>"),a.push('            <span class="l-wrap">'),a.push('                <span class="l-title">{_discount}{goodsName}</span>'),a.push('                <span class="l-desc">{subtitle}</span>'),a.push('					<span class="progress">'),a.push('	                	<span class="store">剩余 {storedCount}件</span>'),a.push('	                	<span class="disc">已抢光</span>'),a.push('	                	<span class="rate" style="width:{_storedCountPercent}"></span>'),a.push("	                </span>"),a.push('                <span class="l-minPrice">{priceHtml}</span>'),a.push('                <span class="l-btns">'),a.push('                		<span class="l-btn l-btn-before">提醒我</span>'),a.push('                		<span class="l-btn l-btn-start">抢购</span>'),a.push('                		<span class="l-btn l-btn-sell">已抢光</span>'),a.push('                		<span class="l-btn l-btn-end">已结束</span>'),a.push("                </span>"),a.push("            </span>"),a.push('            <span class="l-cover"><b>抢光了</b></span>'),a.push("        </article>"),a.push("    </a>"),a.push("</div>"),a=a.join(""),c=function(){var g,e=[],f=".kill["+d+"]";e.push(f+" .l-btn{background-color: #ffc922;border: none;border-radius: 13px;font-size: 14px;font-weight:bold;display:inline-block;vertical-align:middle;height: 26px;line-height: 26px;text-align:center;padding: 0px 20px;color:#333;outline: none;cursor: pointer;display: none;}"),e.push(f+" .l-pri{font-size: 18px;font-weight:bold;color: #CF2D2D;letter-spacing:0;margin-right:0px;}"),e.push(f+" .l-pri i{font-size: 12px;font-style:normal;margin-right: -2px;}"),e.push(f+" .l-pri b{font-size:14px;font-style:normal}"),e.push(f+" .l-del{text-decoration-line:line-through;color:#999;font-weight:normal;margin-left:7px;font-size: 12px;}"),e.push(f+" .l-del i{transform: scale(0.8);display: inline-block;position: relative;top: 1px;}"),e.push(f+"{overflow:hidden;padding:5px 0;background-color:#fff}"),e.push(f+" .l-item{padding:8px 10px;position: relative;}"),e.push(f+' .l-item:after{content:" ";position:absolute;background:#ececec;height:1px;left:150px;right:12px;bottom:0;transform: scale(1,0.5);}'),e.push(f+" .l-item article{width:100%;height:100%;overflow:hidden;position:relative}"),e.push(f+" .l-item a{display:block}"),e.push(f+" .l-item .top{display:none}"),e.push(f+" .l-item .l-discount{display:inline-block;height:16px;line-height:14px;text-align:center;border:1px solid #EC5549;border-radius:3px;font-size:12px;color:#EC5549;transform:scale(0.85);padding:0 3px}"),e.push(f+" .l-item .l-img{width:130px;height:130px;position:relative;display:block;overflow:hidden;border-radius:5px;float:left;margin-right:10px}"),e.push(f+" .l-item .l-img label{display:none}"),e.push(f+" .l-item .l-img img{width:100%;display:block;height:100%}"),e.push(f+" .l-item .l-wrap{overflow:hidden;height:130px;display:block;position:relative}"),e.push(f+" .l-item .l-wrap .l-title{color:#333;display: flex;align-items: center;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-size: 15px;font-weight:bold;}"),e.push(f+" .l-item .l-wrap .l-desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;color:#333;margin-top: 2px;}"),e.push(f+" .l-item .l-wrap .l-minPrice{position:absolute;bottom:0;left:0;color:#333}"),e.push(f+" .l-item .l-wrap .l-Points{display: none;}"),e.push(f+" .l-item .l-wrap .l-btns{position:absolute;bottom:0;right:0}"),e.push(f+" .l-item .l-cover{display:none;position:absolute;top:27px;left:27px;background:#000;border-radius:75px;text-align:center;color:#fff;font-size:20px;opacity:.4;width:75px;height:75px;line-height:75px}"),e.push(f+" .l-item .l-cover b{font-weight:normal}"),e.push(f+" .l-btn-before{color: #CF2D2D;background: transparent;border: 1px solid #CF2D2D;padding: 0px 10px;}"),e.push(f+" .l-btn-disabled{color: #E1E1E1;background: transparent;border: 1px solid #E1E1E1;}"),e.push(f+" .l-btn-start{color: #fff;background: #CF2D2D;}"),e.push(f+" .l-btn-sell{color: #848484;background: #E1E1E1;}"),e.push(f+" .l-btn-end{color: #848484;background: #E1E1E1;}"),e.push(f+" .l-item-before .l-btn {display:none !important;}"),e.push(f+" .l-item-before .l-btn-before{display:inline-block !important;}"),e.push(f+" .l-item-start .l-btn-start{display:inline-block;}"),e.push(f+" .l-item-sell .l-btn-sell{display:inline-block;}"),e.push(f+" .l-item-end .l-btn-end{display:inline-block;}"),e.push(f+" .l-item-sell .l-btn-start{display:none;}"),e.push(f+" .progress{background:#FFD7D7;height:13px;overflow:hidden;border-radius:13px;position:relative;width:80%;display:block;margin-top:8px}"),e.push(f+" .progress .store{z-index: 3;font-size:12px;color:#CF2D2D;transform:scale(0.75);display:block;position:absolute;top:0;right:0;line-height:14px}"),e.push(f+" .progress .disc{font-size:12px;color:#fff;transform:scale(0.75);display:none;position:absolute;top:0px;right:0;left:0;line-height:14px;text-align:center;z-index:3}"),e.push(f+" .progress .rate{border-radius:13px;position:absolute;left:0;top:0;bottom:0;z-index:2;width:20%;background-image:linear-gradient(270deg,#FE7358 9%,#CF2D2D 100%)}"),e.push(f+" .l-item-sell .progress .disc{display:block;}"),e.push(f+" .l-item-sell .progress .store{display:none;}"),e.push(f+" .l-item-end .progress{display:none;}"),g=b.createElement("style"),g.type="text/css",g.innerHTML=e.join(""),b.getElementsByTagName("head")[0].appendChild(g),c=function(){}},f=function(a,b){return a&&a instanceof Object?a:a?(b||document).querySelector(a):null},g=function(a){return Object.prototype.toString.call(a).split(/\s(\w+)/)[1].toLowerCase()},h=function(a,b){a=a||[];for(var c=0,d=a.length;d>c&&0!=b.call(a[c],c,a[c]);c++);},i=[],j=function(a,b,c){h("array"!=g(a)?[a]:a,function(a,d){b.split(" ").forEach(function(a){d.addEventListener(a,c,{passive:!1}),i.push({elem:d,type:a,handle:c})})})},l=function(a,b){for(var c in b)b.hasOwnProperty(c)&&("object"!=g(b[c])?void 0!=b[c]&&(a[c]=b[c]):a[c]=l(a[c]||{},b[c]));return a},m=function(a,c){a=b.createElement(a);for(var d in c)c.hasOwnProperty(d)&&("style"==d?l(a.style,c[d]):a[d]=c[d]);return a},n=function(a,b,c){var d=CY.stringUtil.comma(Number(a||0).toFixed(b));return d=d.replace(/(\.\d+)$/,"<b>$1</b>"),'<span class="l-pri '+(c||0)+'"><i>￥</i>'+d+"</span>"},o=function(a){return'<span class="l-Points"><b>'+(a||0)+"</b>积分</span>"},p=function(a){var b="",c=a/10;return a&&9.51>c&&(b='<span class="l-discount">'+parseFloat(c.toFixed(1))+"折</span>",1>c&&(b='<span class="l-discount">超值</span>')),b},r=function(a,b,c){var d="l-item-";return b>a?d+="before":a>b&&c>a?d+="start":a>c&&(d+="end"),d},function(b,g){var h,i,k;b=f(b),d=d||e("kill"),c(),g=l({teml:a,css:"",data:null,onBefore:function(){},onAfter:function(){}},g),h=g.keyId,i=function(a){CY.serverUtil.getCurrTime(function(c){var h,i,k,l,q,t,s,u,v,w,x,d=c.getTime(),e=a.goodsList||[],f=("https:"==location.protocol?"https:":"http:")+CY.serverUtil.imgUrl+"/";for(g.onBefore(e,g,b),h=[],e.sort(function(a,b){return b.sort-a.sort}),i=a.startTime,k=a.endTime,s=0,u=e.length;u>s;s++)t=e[s],t.index=s+1,t.topCss="top_"+t.index,t.storedCount<0&&(t.storedCount=0),0==t.storedCount&&d<t.endTime&&(t.statusCSS="l-item-sell"),!/^http/.test(t.centerPic)&&!/^data:/.test(t.centerPic)&&(t.centerPic=f+t.centerPic),t.link="/mall/#/flashSale?productId="+t.productId+"&channelNo="+a.activityId,l=n(t.price/100,2)+n(t.marketPrice/100,0,"l-del"),q=o(t.points),"cust"==t.payType||"cash"==t.payType?(t.priceHtml=l,"cust"==t.payType&&(t.label="任意积分抵扣","01"==t.displayEnable&&(t.label="支持现金购买",t.priceHtml=q))):t.priceHtml="comb"==t.payType?q+" + "+n(t.price/100,2):q,t._discount=p(t.discount),t._storedCountPercent=100-parseFloat(t.storedCountPercent)+"%",h.push(CY.stringUtil.substitute(g.teml,t));for(b.innerHTML="",v=m("div",{className:"content "+r(d,i,k),innerHTML:h.join("")}),b.appendChild(v),w=b.querySelectorAll(".l-btn-before")||[],x=0,u=w.length;u>x;x++)!function(b,c){var d=!1,e=b.remindFlag;j(c,"click",function(f){f.preventDefault(),d||(d=!0,CY.userUtil.checkLogin(function(){CY.ajaxUtil.loadData("/pointgate/mall/service/panicBuying/remind",{method:"POST",standard:!0,body:{type:e,productId:b.productId,activityId:a.activityId,loginToken:CY.userUtil.get()}}).then(function(a){"0000"==a.respCode?(d=!1,"00"==e?(CY.ui.toast("系统会在开抢前2分钟发短信提醒您~"),e="01",c.innerHTML="取消提醒"):(e="00",c.innerHTML="提醒我")):CY.ui.toast(a.respMsg)})}))}),c.innerHTML="00"==e?"提醒我":"取消提醒"}(e[x],w[x]);g.onAfter(e,g,b)})},b.setAttribute(d,""),b.setAttribute("keyId",h),b.classList.add("kill"),g.data?i(g.data):(k=function(){CY.ajaxUtil.loadData("/pointgate/mall/service/panicBuying/query",{method:"POST",standard:!0,body:{loginToken:spm.util.cookie.get("login_token")||"",activityId:h}}).then(function(a){"0000"==a.respCode&&i(a.data)})},k())}}(),a.CY.kill=c,c)});